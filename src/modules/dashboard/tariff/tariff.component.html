<div class="container mb-5">
  <p>Upload Tariff</p>
  <div class="row">
    <div class="mb-2 d-md-flex">
      <div class="">
        <form class="">
          <div class="files">
            <!--<label>Upload Your File </label>-->

            <input
              type="file"
              class="form-control"
              (change)="onImageChange($event)"
            />
          </div>
          <p class="ps-4" *ngIf="filename">
            Uploaded : <b>{{ filename }}</b>
          </p>
        </form>
      </div>
      <div class="sample-sheet">
        <div>
          <a href="../../../assets/excel/tariff_sheet.xlsx" download>
            <img
              src="../../../assets/images/download-to-storage-drive.png"
              alt="download-to-storage-drive"
              class="pe-1"
            />
            Generate sample sheet</a
          >
        </div>
      </div>
    </div>
  </div>
  <div class="mb-5">
    <p class="text-danger" *ngIf="!filename && invsheet">
      <b>Ivalid type... Upload a excel sheet (.xlsx)</b>
    </p>
  </div>
  <div class="" style="margin-bottom: 10rem" *ngIf="filename">
    <div>
      <button
        type="submit"
        class="button-43 button-40 rounded-pill mt-2 ms-4 mb-2"
        (click)="addrow()"
      >
        Add
      </button>
    </div>
    <div class="table-div">
      <table class="mb-5">
        <thead class="mt-2">
          <tr class="">
            <th class="p-2">Zone</th>
            <th>Country</th>
            <th>Network Operator</th>
            <th>Network Code</th>
            <th>Increment</th>
            <th></th>
          </tr>
        </thead>
        <tbody class="mt-2">
          <tr
            class="border-bottom sortable"
            *ngFor="let row of data; let indexrow = index"
          >
            <td *ngFor="let val of row | keyvalue; let indexcol = index">
              <input
                type="text"
                class="rounded-pill inputclass p-1"
                [value]="val.value"
                [ngClass]="{
                  highlight:
                    (col1 === indexcol && zoneindex.includes(val.value)) ||
                    (col4 === indexcol &&
                      (row1.includes(indexrow) || cvalue.includes(indexrow))) ||
                    (col5 === indexcol && inc.includes(indexrow))
                }"
                (focus)="getData($event, indexrow, indexcol)"
                (blur)="getData($event, indexrow, indexcol)"
              />
            </td>

            <td class="align-middle">
              <a class="delete-icon" (click)="del(indexrow)">
                <img
                  src="https://img.icons8.com/material-sharp/24/000000/filled-trash.png"
                />
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div>
      <div>
        <button
          type="submit"
          class="button-40 button-42 rounded-pill mt-2 ms-4 mb-2"
          (click)="cancel()"
        >
          Cancel
        </button>
      </div>
      <div>
        <button
          type="submit"
          class="button-40 button-43 rounded-pill mt-2 ms-4 mb-2"
          (click)="export()"
        >
          Confirm
        </button>
      </div>
    </div>
  </div>
</div>
